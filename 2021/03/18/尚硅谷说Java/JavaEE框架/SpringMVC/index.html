<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"plumv.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="REST风格请求，视图解析，表单处理，静态资源放行，数据的校验，JSON格式返回值国际化处理，文件的上传，拦截器，异常处理，与Spring的整合。">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringMVC的学习">
<meta property="og:url" content="https://plumv.github.io/2021/03/18/%E5%B0%9A%E7%A1%85%E8%B0%B7%E8%AF%B4Java/JavaEE%E6%A1%86%E6%9E%B6/SpringMVC/index.html">
<meta property="og:site_name" content="李川的个人博客">
<meta property="og:description" content="REST风格请求，视图解析，表单处理，静态资源放行，数据的校验，JSON格式返回值国际化处理，文件的上传，拦截器，异常处理，与Spring的整合。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210316083419.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210316173330.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210316173700.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210316173913.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210318134325.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210317205109.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210317213832.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210317213909.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210318100613.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210318100617.png">
<meta property="og:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210318125159.png">
<meta property="article:published_time" content="2021-03-17T16:00:00.000Z">
<meta property="article:modified_time" content="2021-03-21T13:05:27.316Z">
<meta property="article:author" content="Plum Reiver">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210316083419.png">

<link rel="canonical" href="https://plumv.github.io/2021/03/18/%E5%B0%9A%E7%A1%85%E8%B0%B7%E8%AF%B4Java/JavaEE%E6%A1%86%E6%9E%B6/SpringMVC/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SpringMVC的学习 | 李川的个人博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">李川的个人博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">学习生活</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>日志</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://plumv.github.io/2021/03/18/%E5%B0%9A%E7%A1%85%E8%B0%B7%E8%AF%B4Java/JavaEE%E6%A1%86%E6%9E%B6/SpringMVC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Plum Reiver">
      <meta itemprop="description" content="技术，日常，笔记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李川的个人博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SpringMVC的学习
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-18 00:00:00" itemprop="dateCreated datePublished" datetime="2021-03-18T00:00:00+08:00">2021-03-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-03-21 21:05:27" itemprop="dateModified" datetime="2021-03-21T21:05:27+08:00">2021-03-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">Java学习</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java%E5%AD%A6%E4%B9%A0/JavaEE%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">JavaEE框架</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>REST风格请求，视图解析，表单处理，静态资源放行，数据的校验，JSON格式返回值<br>国际化处理，文件的上传，拦截器，异常处理，与Spring的整合。</p>
<span id="more"></span>

<ul>
<li>基于Spring4版本</li>
</ul>
<h1 id="第一章-入门"><a href="#第一章-入门" class="headerlink" title="第一章 入门"></a>第一章 入门</h1><ul>
<li>Spring 为展现层提供的基于 MVC 设计理念的优秀的Web 框架，是目前最主流的 MVC 框架之一。</li>
<li>Spring3.0 后全面超越 Struts2，成为最优秀的 MVC 框架。</li>
<li>Spring MVC 通过一套 MVC 注解，让 POJO 成为处理请求的控制器，而无须实现任何接口。</li>
<li>支持 REST 风格的 URL 请求 。</li>
<li>采用了松散耦合可插拔组件结构，比其他 MVC 框架更具扩展性和灵活性。</li>
</ul>
<p><strong>第一个hello world</strong></p>
<ul>
<li><p>创建java web工程。</p>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210316083419.png"></p>
</li>
<li><p>加入下列jar包。</p>
<ul>
<li>commons-logging-1.1.3.jar</li>
<li>spring-aop-4.0.0.RELEASE.jar</li>
<li>spring-beans-4.0.0.RELEASE.jar</li>
<li>spring-context-4.0.0.RELEASE.jar</li>
<li>spring-core-4.0.0.RELEASE.jar</li>
<li>spring-expression-4.0.0.RELEASE.jar</li>
<li>spring-web-4.0.0.RELEASE.jar</li>
<li>spring-webmvc-4.0.0.RELEASE.jar</li>
</ul>
</li>
<li><p>编写web.xml配置文件</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--配置dispatcherServlet--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置初始化参数。作用：指明SpringMVC配置文件的位置和名称--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--当不通过配置初始化参数指定springmvc配置文件时，可以通过默认的路径即可。</span></span><br><span class="line"><span class="comment">    默认的路径为/WEB-INF/&lt;servlet-name&gt;-servlet.xml。</span></span><br><span class="line"><span class="comment">    例如：当前的默认配置文件的位置为/WEB-INF/dispatcherServlet-servlet.xml--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>编写springmvc的配置信息</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--配置自动扫描的包--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.lc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--配置视图处理器：如何把控制器controller的返回值解析为实际的物理视图--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/views/&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>编写控制器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 使用RequestMapping注解来映射请求的URL</span></span><br><span class="line"><span class="comment">   * 返回值会通过视图解析器拼接成实际的物理视图。对于InternalResourceViewResolver解析器会做如下的解析：</span></span><br><span class="line"><span class="comment">   * 通过 prefix + 返回值 + suffix 的方式得到实际的物理视图，然后做转发操作</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@RequestMapping(&quot;/helloworld&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>配置dispatcherServlet<ul>
<li>DispatcherServlet 默认加载 /WEB-INF/&lt;servletName&gt;-servlet.xml 的 Spring 配置文件, 启动 WEB 层 的 Spring 容器。</li>
<li>可以通过 contextConfigLocation 初始化参数自定义配置文件的位置和名称。</li>
</ul>
</li>
<li>配置注解扫描：让controller注解起作用。</li>
<li>配置视图解析器：将返回值解析为具体的jsp的路径。<ul>
<li>对于InternalResourceViewResolver解析器会做如下的解析：<ul>
<li>通过 prefix + 返回值 + suffix 的方式得到实际的物理视图，然后做转发操作。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="第二章-RequestMapping注解"><a href="#第二章-RequestMapping注解" class="headerlink" title="第二章 RequestMapping注解"></a>第二章 RequestMapping注解</h1><ul>
<li><p>Spring MVC 使用 <strong>@RequestMapping</strong> 注解为控制器指定可以处理哪些 URL 请求。</p>
</li>
<li></li>
<li><p>在控制器的类定义及方法定义处都可标注。</p>
<ul>
<li>类定义处：提供初步的请求映射信息。相对于 WEB 应用的根目录</li>
<li>方法处：提供进一步的细分映射信息。相对于类定义处的 URL。若类定义处未标注 @RequestMapping，则方法处标记的 URL 相对于WEB 应用的根目录</li>
</ul>
<p>例如:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当访问路径为：http://localhost:8080/SpringMVC1_war_exploded/hello/world时才会调用hello()方法处理请求。</span></span><br><span class="line"><span class="comment">//当访问路径为：http://localhost:8080/SpringMVC1_war_exploded/hello时，表示使用HelloController中的某个方法进行处理请求。</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">  <span class="meta">@RequestMapping(&quot;/world&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>DispatcherServlet 截获请求后，就通过控制器上@RequestMapping 提供的映射信息确定请求所对应的处理<br>方法。</p>
</li>
</ul>
<h2 id="2-1-RequestMapping的属性"><a href="#2-1-RequestMapping的属性" class="headerlink" title="2.1 @RequestMapping的属性"></a>2.1 @RequestMapping的属性</h2><ul>
<li>@RequestMapping 除了可以指定请求 URL 映射外，还可以指定请求方法、请求参数及请求头映射请求。</li>
<li>@RequestMapping 的 value、method、params 及 heads 分别表示请求 URL、请求方法、请求参数及请求头的映射条件，他们之间是<strong>与</strong>的关系，联合使用多个条件可让请求映射更加精确化。<ul>
<li>当加上多个条件时，@RequestMapping的方法只会处理符合条件的请求url。</li>
<li>params 及 heads可以支持多个条件。</li>
<li>method的值为RequestMethod枚举类的所有属性。表示请求的类型。例如get，post，put请求等。</li>
</ul>
</li>
<li>params 和 headers支持<strong>简单的表达式</strong><ul>
<li>param1: 表示请求必须包含名为 param1 的请求参数</li>
<li> !param1: 表示请求不能包含名为 param1 的请求参数</li>
<li>param1 != value1: 表示请求包含名为 param1 的请求参数，但其值不能为 value1</li>
<li>{“param1=value1”, “param2”}: 请求必须包含名为 param1 和param2 的两个请求参数，且 param1 参数的值必须为 value1</li>
</ul>
</li>
<li>举例：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@RequestMapping(value = &quot;/test&quot;,method = RequestMethod.POST,</span></span><br><span class="line"><span class="meta">        params = &#123;&quot;username&quot;,&quot;age!=10&quot;&#125;,headers = &#123;&quot;contentType=html/*&quot;&#125;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>说明：<ul>
<li>value：表示请求的url为<a target="_blank" rel="noopener" href="http://localhost:8080/SpringMVC1_war_exploded/test%E3%80%82">http://localhost:8080/SpringMVC1_war_exploded/test。</a></li>
<li>method：表示请求的类型要为POST请求。</li>
<li>params：表示请求的参数要带username属性和age属性，且age属性的值不能为10。</li>
<li>headers：表示请求头要有contentType属性，且属性值为html/*。*表示全匹配。</li>
<li>以上四个条件都满足的请求才能被这个方法处理。</li>
</ul>
</li>
</ul>
<h2 id="2-2-RequestMapping注解请求映射的风格"><a href="#2-2-RequestMapping注解请求映射的风格" class="headerlink" title="2.2 RequestMapping注解请求映射的风格"></a>2.2 RequestMapping注解请求映射的风格</h2><ul>
<li>Ant 风格资源地址支持 3 种匹配符： <ul>
<li>?    ：匹配文件名中的一个字符。</li>
<li>*    ：匹配文件名中的任意字符。</li>
<li>**   ： 匹配多层路径。</li>
</ul>
</li>
<li> @RequestMapping 还支持 Ant 风格的 URL：</li>
<li> /user/*/createUser: 匹配 /user/aaa/createUser、/user/bbb/createUser 等 URL</li>
<li> /user/**/createUser: 匹配/user/createUser、/user/aaa/bbb/createUser 等 URL。</li>
<li> /user/createUser??: 匹配/user/createUseraa、/user/createUserbb 等 URL。</li>
<li>例如：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//请求路径为：http://localhost:8080/SpringMVC1_war_exploded/test2/asd 。asd可以替换成任意英文，但只能匹配一层。</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test2/*&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-3-PathVariable-映射-URL-绑定的占位符"><a href="#2-3-PathVariable-映射-URL-绑定的占位符" class="headerlink" title="2.3 @PathVariable 映射 URL 绑定的占位符"></a>2.3 @PathVariable 映射 URL 绑定的占位符</h2><ul>
<li>带占位符的 URL 是 Spring3.0 新增的功能，该功能在SpringMVC 向 REST 目标挺进发展过程中具有里程碑的意义 </li>
<li>通过 @PathVariable 可以将 URL 中占位符参数绑定到控制器处理方法的入参中：<ul>
<li>URL 中的 {xxx} 占位符可以通过 @PathVariable(“xxx”) 绑定到操作方法的参数中。</li>
<li>@PathVariable注解中的字母和占位符的字母要保持一致。</li>
<li>@PathVariable注解还会将请求中的值自动解析成形参的类型。</li>
</ul>
</li>
<li>例如：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//访问路径为：http://localhost:8080/SpringMVC1_war_exploded/test3/100</span></span><br><span class="line"><span class="comment">//此时形参中的id的值为100</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test3/&#123;qid&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test3</span><span class="params">(<span class="meta">@PathVariable(&quot;qid&quot;)</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="第三章-REST风格"><a href="#第三章-REST风格" class="headerlink" title="第三章 REST风格"></a>第三章 REST风格</h1><ul>
<li><p>REST：即 Representational State Transfer。（资源）表现层状态转化。是目前最流行的一种互联网软件架构。它结构清晰、符合标准、易于理解、扩展方便，所以正得到越来越多网站的采用。</p>
</li>
<li><p>资源（Resources）：网络上的一个实体，或者说是网络上的一个具体信息。它可以是一段文本、一张图片、一首歌曲、一种服务，总之就是一个具体的存在。可以用一个URI（统一资源定位符）指向它，每种资源对应一个特定的 URI 。要 获取这个资源，访问它的URI就可以，因此 URI 即为每一个资源的独一无二的识 别符。 </p>
</li>
<li><p>表现层（Representation）：把资源具体呈现出来的形式，叫做它的表现层（Representation）。比如，文本可以用 txt 格式表现，也可以用 HTML 格 式、XML 格式、JSON 格式表现，甚至可以采用二进制格式。</p>
</li>
<li><p>状态转化（State Transfer）：每发出一个请求，就代表了客户端和服务器的一次交互过程。HTTP协议，是一个无状态协议，即所有的状态都保存在服务器端。因此，如果客户端想要操作服务器，必须通过某种手段，让服务器端发生“ 状态转化”（State Transfer）。而这种转化是建立在表现层之上的，所以就是 “ 表现层状态转化”。</p>
</li>
<li><p>具体说，就是 HTTP 协议里面，四个表示操作方式的动 词：GET、POST、PUT、DELETE。它们分别对应四种基本操作：GET 用来获 取资源，POST 用来新建资源，PUT 用来更新资源，DELETE 用来删除资源。</p>
</li>
<li><p>浏览器 form 表单只支持 GET 与 POST 请求，而DELETE、PUT 等 method 并不支 持，Spring3.0 添加了一个过滤器，可以将这些请求转换为标准的 http 方法，使得支持 GET、POST、PUT 与DELETE 请求。</p>
<ul>
<li>HiddenHttpMethodFilter过滤器：能够将POST请求转换成PUT和DELETE请求。</li>
</ul>
</li>
<li><p>格式：</p>
<ul>
<li>get请求：/order/1 。请求中需要指明要获取的资源名称，且指明当前请求是GET请求。</li>
<li>post请求：/order 。请求中传递数据即可，且指明当前请求是POST请求。</li>
<li>put请求：/order/1 。请求中需要指明要更新的资源名称，且指明当前请求是POST请求。<ul>
<li>并且在请求中设置一个隐藏的属性。属性名为_method。属性值为PUT。</li>
</ul>
</li>
<li>delete请求：/order/1 。请求中需要指明要删除的资源名称，且指明当前请求是POST请求。<ul>
<li>并且在请求中设置一个隐藏的属性。属性名为_method。属性值为DELETE。</li>
</ul>
</li>
</ul>
</li>
<li><p>使用步骤：</p>
<ul>
<li>第一步：在web.xml中配置HiddenHttpMethodFilter过滤器。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>第二步：前端页面代码</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;testPost/1&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;DELETE&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sumbitDelete&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;testPost/1&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;PUT&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sumbitPut&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;testPost&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sumbitPost&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;testGet/1&quot;</span>&gt;</span>testGet<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>第三步：后台接收代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/testGet/&#123;qid&#125;&quot;,method = RequestMethod.GET)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testGet</span><span class="params">(<span class="meta">@PathVariable(&quot;qid&quot;)</span> Integer id)</span></span>&#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;testGet &quot;</span> + id);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/testPost&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testPost</span><span class="params">()</span></span>&#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;testPost &quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/testPost/&#123;qid&#125;&quot;,method = RequestMethod.PUT)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testPut</span><span class="params">(<span class="meta">@PathVariable(&quot;qid&quot;)</span> Integer id)</span></span>&#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;testPut &quot;</span> + id);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/testPost/&#123;qid&#125;&quot;,method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testDelete</span><span class="params">(<span class="meta">@PathVariable(&quot;qid&quot;)</span> Integer id)</span></span>&#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;testDelete &quot;</span> + id);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><font color="red">注意事项：</font></p>
<ul>
<li><p>当请求被控制接收到，但在返回页面时出现405错误的提示。有如下方法解决：</p>
<ul>
<li>1.将Tomcat版本降低为8以下的版本。</li>
<li>2.@RestController 或者 @Controller + @ResponseBody 标签，但是这样就无法跳转页面了。</li>
<li>3.避免使用 forward 方式跳转页面，改为 重定向redirect方式跳转到另一个控制器方法，再由这个控制器方法跳转页面。</li>
<li>例如：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/rest&quot;, method = RequestMethod.PUT)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">put</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 接收表单中的各种信息</span></span><br><span class="line">	System.out.println(<span class="string">&quot;PUT --- 更新数据&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;redirect:/success&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/success&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">success</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>4.给Tomcat添加启动参数，使Tomcat允许读写操作</li>
<li>5.创建一个新的Filter来实现HiddenHttpMethodFilter的功能。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="第四章-映射请求参数和请求参数"><a href="#第四章-映射请求参数和请求参数" class="headerlink" title="第四章 映射请求参数和请求参数"></a>第四章 映射请求参数和请求参数</h1><h2 id="4-1-请求参数"><a href="#4-1-请求参数" class="headerlink" title="4.1 请求参数"></a>4.1 请求参数</h2><ul>
<li><p>Spring MVC 通过分析处理方法的签名，将 HTTP 请求信息绑定到处理方法的相应人参中。 </p>
</li>
<li><p>Spring MVC 对控制器处理方法签名的限制是很宽松的，几乎可以按喜欢的任何方式对方法进行签名。</p>
</li>
<li><p>必要时可以对方法及方法入参标注相应的注解（ @PathVariable、@RequestParam、@RequestHeader 等）、Spring MVC 框架会将 HTTP 请求的信息绑定到相应的方法入参中，并根据方法的返回值类型做出相应的后续处理。</p>
</li>
<li><p>在处理方法入参处使用 @RequestParam 可以把请求参数传递给请求方法</p>
<ul>
<li>value：参数名</li>
<li>required：是否必须。默认为 true, 表示请求参数中必须包含对应的参数，若不存在，将抛出异常。</li>
<li>defaultValue：默认值。当请求中不包含此参数时，默认值即为形参的值。当形参类型为基本类型时，需要带上默认值。否则会报错。</li>
</ul>
</li>
<li><p>示例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//访问路径为：http://localhost:8080/SpringMVC1_war_exploded/test4?name=root&amp;age=11</span></span><br><span class="line"><span class="comment">//也可以为：http://localhost:8080/SpringMVC1_war_exploded/test4?name=root</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test4&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test4</span><span class="params">(<span class="meta">@RequestParam(&quot;name&quot;)</span> String name,</span></span></span><br><span class="line"><span class="function"><span class="params">                    <span class="meta">@RequestParam(value = &quot;age&quot;,required = false,defaultValue = &quot;0&quot;)</span> <span class="keyword">int</span> age)</span></span>&#123;</span><br><span class="line">  System.out.println(name + <span class="string">&quot; &quot;</span> + age);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>上述代码的几种情况：</p>
<ul>
<li>当请求中不传递age时，需要在@RequestParam 注解添加required=false。</li>
<li>当请求中不传递age时，且添加了required=false。<ul>
<li>此时，如果age为int类型，会报错。需要再添加defaultValue属性。</li>
<li>此时，如果age为Integer类型，不会报错，age的值为null。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="4-2-请求头"><a href="#4-2-请求头" class="headerlink" title="4.2 请求头"></a>4.2 请求头</h2><ul>
<li>请求头包含了若干个属性，服务器可据此获知客户端的信息，通过 @RequestHeader 即可将请求头中的属性值绑定到处理方法的入参中。</li>
<li>@RequestHeader注解的值即为要获取的请求头的哪个属性。</li>
<li>使用方法：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/test5&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">(<span class="meta">@RequestHeader(&quot;Accept-Encoding&quot;)</span> String encoding)</span></span>&#123;</span><br><span class="line">  System.out.println(encoding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-3-Cookie信息的获取"><a href="#4-3-Cookie信息的获取" class="headerlink" title="4.3 Cookie信息的获取"></a>4.3 Cookie信息的获取</h2><ul>
<li><strong>@CookieValue</strong> 可让处理方法入参绑定某个 Cookie 值。即获取指定Cookie属性的值为参数传递给控制方法。</li>
<li>使用方法：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/test6&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6</span><span class="params">(<span class="meta">@CookieValue(value = &quot;JSESSIONID&quot;,required = false)</span> String sessionId)</span></span>&#123;</span><br><span class="line">  System.out.println(sessionId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-4-POJO对象绑定"><a href="#4-4-POJO对象绑定" class="headerlink" title="4.4 POJO对象绑定"></a>4.4 POJO对象绑定</h2><ul>
<li>Spring MVC 会按请求参数名和 POJO 属性名进行自动匹配，自动为该对象填充属性值。支持级联属性。</li>
<li>示例：</li>
<li>两个对象。要有get和set方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String username;</span><br><span class="line">  <span class="keyword">private</span> String password;</span><br><span class="line">  <span class="keyword">private</span> Address address;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String province;</span><br><span class="line">  <span class="keyword">private</span> String county;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>页面代码</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;testPOJO&quot;</span> &gt;</span></span><br><span class="line">  用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  所在市：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;address.province&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  所在县：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;address.county&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>后端测试代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testPOJO&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testPOJO</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">  System.out.println(user.toString());</span><br><span class="line">  System.out.println(user.getAddress().toString());</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-5-接受Servlet的原生API参数"><a href="#4-5-接受Servlet的原生API参数" class="headerlink" title="4.5 接受Servlet的原生API参数"></a>4.5 接受Servlet的原生API参数</h2><ul>
<li>在接收参数时，可以接受servlet的一些原生参数。有以下几种：<ul>
<li>HttpServletRequest  ：请求</li>
<li>HttpServletResponse  ：响应</li>
<li>HttpSession  ：Session域</li>
<li> java.security.Principal ：安全认证标识符</li>
<li>Locale：时区地址</li>
<li>InputStream：读取请求主体</li>
<li>OutputStream：写入请求主体</li>
<li>Reader：读取请求正文</li>
<li>Writer：写入请求正文</li>
</ul>
</li>
<li>示例：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/test7&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test7</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span>&#123;</span><br><span class="line">  System.out.println(request + <span class="string">&quot; &quot;</span> + response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="第五章-模型数据"><a href="#第五章-模型数据" class="headerlink" title="第五章 模型数据"></a>第五章 模型数据</h1><ul>
<li>Spring MVC 提供了以下几种途径输出模型数据：<ul>
<li>ModelAndView: 处理方法返回值类型为 ModelAndView时, 方法体即可通过该对象添加模型数据。</li>
<li>Map 及 Model: 入参为org.springframework.ui.Model、org.springframework.ui.ModelMap 或 java.uti.Map 时，处理方法返回时，Map 中的数据会自动添加到模型中。</li>
<li>@SessionAttributes: 将模型中的某个属性暂存到HttpSession 中，以便多个请求之间可以共享这个属性。</li>
<li>@ModelAttribute: 方法入参标注该注解后, 入参的对象就会放到数据模型中。</li>
</ul>
</li>
<li>总结：<ul>
<li>ModelAndView用于往request域中添加属性，且可以设置返回的页面，或新建一个页面作为返回的页面。</li>
<li>Map 及 Model只用于传递数据，即将数据添加到request域属型中。</li>
<li>@SessionAttributes也只用于传递数据，但是将数据添加到Session域中。</li>
<li>当使用SessionAttributes和ModelAttribute注解时，此注解</li>
</ul>
</li>
</ul>
<h2 id="5-1-ModelAndView"><a href="#5-1-ModelAndView" class="headerlink" title="5.1 ModelAndView"></a>5.1 ModelAndView</h2><ul>
<li>ModelAndView既包含视图信息，也包含模型数据信息。</li>
<li>使用方式：将其作为控制方法的返回值类型。</li>
<li>添加模型数据: <ul>
<li>MoelAndView addObject(String attributeName, Object attributeValue) </li>
<li> ModelAndView addAllObject(Map&lt;String, ?&gt; modelMap) </li>
</ul>
</li>
<li>设置视图: <ul>
<li>void setView(View view) </li>
<li>void setViewName(String viewName)</li>
</ul>
</li>
<li>示例：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/test8&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">test8</span><span class="params">()</span></span>&#123;</span><br><span class="line">  ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">  <span class="comment">//添加属性键值对。实际上是往request域中添加键值对。</span></span><br><span class="line">  modelAndView.addObject(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">  <span class="comment">//添加返回的页面视图名称</span></span><br><span class="line">  modelAndView.setViewName(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-2-Map-及Model"><a href="#5-2-Map-及Model" class="headerlink" title="5.2 Map 及Model"></a>5.2 Map 及Model</h2><ul>
<li>Spring MVC 在调用方法前会创建一个隐含的模型对象作为模型数据的存储容器。 </li>
<li>如果控制方法的参数为 Map 或 Model 类 型，Spring MVC 会将隐含模型的引用传递给这些入参。在方法体内，开发者可以通过这个入参对象访问到模型中的所有数据，也可以向模型中添加新的属性数据。</li>
<li>示例：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/test9&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test9</span><span class="params">(Map&lt;String,String&gt; map)</span></span>&#123;</span><br><span class="line">  map.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>与ModelAndView的区别：<ul>
<li>由于model和map只能传递数据，因此它不能作为返回值，因为它无法指明返回页面。</li>
<li>model和map是在调用控制方法前就创建的隐含式模型数据的存储容器。</li>
<li>相同之处：都是往request域中添加域属型</li>
</ul>
</li>
</ul>
<h2 id="5-3-SessionAttributes注解"><a href="#5-3-SessionAttributes注解" class="headerlink" title="5.3 @SessionAttributes注解"></a>5.3 @SessionAttributes注解</h2><ul>
<li>若希望在多个请求之间共用某个模型属性数据，则可以在控制器类上标注一个 @SessionAttributes, Spring MVC 将在模型中对应的属性暂存到 HttpSession 中。</li>
<li>@SessionAttributes 除了可以通过属性名指定需要放到会话中的属性外，还可以通过模型属性的对象类型指定哪些模型属性需要放到会话中。</li>
<li>@SessionAttributes 有两个属性，都是指明在此控制类中所有的模型数据中的哪些数据要添加到session域中。<ul>
<li>value：以数据的key为此属性的值，可以有多个值。</li>
<li>types：以数据的类的类型为此属性的值，也可以有多个值。</li>
</ul>
</li>
<li>示例</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SessionAttributes(value = &#123;&quot;name&quot;&#125;,types = &#123;User.class&#125;)</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">  <span class="meta">@RequestMapping(&quot;/test9&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">test9</span><span class="params">(Map&lt;String,String&gt; map)</span></span>&#123;</span><br><span class="line">    map.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-4-ModelAttribute注解"><a href="#5-4-ModelAttribute注解" class="headerlink" title="5.4 @ModelAttribute注解"></a>5.4 @ModelAttribute注解</h2><ul>
<li><p>使用位置：在方法上，控制方法的形参上，控制方法的返回值上。</p>
</li>
<li><p>在方法上：Spring MVC 在调用目标处理方法前，会先逐个调用在方法级上标注了@ModelAttribute 的所有方法。</p>
<ul>
<li>每次调用控制层的方法，都会执行一次所有标注了@ModelAttribute 的方法。</li>
<li>作用：</li>
<li>这些方法都有map或model作为形参，这些map和model都是ModelAttribute的。</li>
<li>在这些方法中，可以将创建的数据对象添加到map或model中。</li>
<li>此时ModelAttribute中就会有数据对象，且数据对象的引用key也就被确定了。</li>
<li>然后，当SpringMVC调用控制方法时，如果有方法的形参类型的第一个首字母小写的字符串与key相同。</li>
<li>则将该数据对象作为形参的初始值，然后在接受到请求参数对初始值进行更新，最后的数据会被传入到控制方法中</li>
<li>简化版说明：<ul>
<li>ModelAttribute注解的方法中往ModelAttribute中存放了一个user对象。</li>
<li>请求到控制方法时，方法中的形参有一个user,</li>
<li>形参的user先以ModelAttribute的user为模板创建，然后在接受请求的参数，将请求参数值绑定到user中。</li>
<li>最后将user作为形参传递给控制方法。</li>
<li>同时，也会将user放入到request域中</li>
</ul>
</li>
<li>注意：ModelAttribute的key要和形参的类名首字母小写相匹配时，才能起作用。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ModelAttribute</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUser</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">  user.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">  model.addAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//访问为：http://localhost:8080/SpringMVC1_war_exploded/test10?username=admin</span></span><br><span class="line"><span class="comment">//因为User类的首字母小写后与ModelAttribute中的key相同</span></span><br><span class="line"><span class="comment">//此时user的初始值为&#123;username=root,password=root&#125;</span></span><br><span class="line"><span class="comment">//在接受到请求参数后，user变成了：&#123;username=admin,password=root&#125;</span></span><br><span class="line"><span class="comment">//最后传入方法的user为：&#123;username=admin,password=root&#125;</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test10&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test10</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>在控制方法的形参上：用于指明将哪个key的数据对象赋给这个形参。然后请求参数绑定到形参中。最后的形参对象会被添加到ModelAttribute，覆盖先前的数据对象，key不变。</p>
<ul>
<li>一般用于解决ModelAttribute的key和形参类名小写不一致的情况。</li>
<li>与不加ModelAttribute注解的形参的区别：不加时，只会赋给形参，不会覆盖老数据对象。</li>
<li>最后的形参对象不仅会添加到ModelAttribute中，也会放到request域中。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/test10&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test10</span><span class="params">(<span class="meta">@ModelAttribute(&quot;user&quot;)</span> User user)</span></span>&#123;</span><br><span class="line">  System.out.println(user);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：当ModelAttribute被应用在形参上，但是ModelAttribute中没有对应的数据对象此时就会验证SessionAttributes注解。<ul>
<li>如果当前控制类没有此注解，则通过反射创建空的对象。</li>
<li>如果当前控制类有此注解，此时又分为两种情况：<ul>
<li>如果SessionAttributes中有此对象数据，则赋给形参，最后再将形参添加到ModelAttribute中。</li>
<li>如果SessionAttributes中没有此对象数据，则抛异常：<strong>HttpSessionRequiredException</strong></li>
</ul>
</li>
</ul>
</li>
<li>控制方法的返回值上：将返回值的数据存储到ModelAttribute中，如果原先有，就覆盖。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/test10&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@ModelAttribute(&quot;user&quot;)</span> <span class="function">User <span class="title">test10</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  System.out.println(user);</span><br><span class="line">  <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="第六章-视图及视图解析器"><a href="#第六章-视图及视图解析器" class="headerlink" title="第六章 视图及视图解析器"></a>第六章 视图及视图解析器</h1><ul>
<li>请求处理方法执行完成后，最终返回一个 ModelAndView对象。对于那些返回 String，View 或 ModeMap 等类型的处理方法，Spring MVC 也会在内部将它们装配成一个ModelAndView 对象，它包含了逻辑名和模型对象的视图。</li>
</ul>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210316173330.png"></p>
<ul>
<li>Spring MVC 借助视图解析器（ViewResolver）得到最终 的视图对象（View），最终的视图可以是 JSP ，也可能是Excel、JFreeChart 等各种表现形式的视图。</li>
<li>对于最终究竟采取何种视图对象对模型数据进行渲染，处理器(controller)并不关心，处理器工作重点聚焦在生产模型数据的工作上，从而实现 MVC 的充分解耦。</li>
</ul>
<h2 id="6-1-视图"><a href="#6-1-视图" class="headerlink" title="6.1 视图"></a>6.1 视图</h2><ul>
<li><p>视图的作用是渲染模型数据，将模型里的数据以某种形式呈现给客户。</p>
</li>
<li><p>为了实现视图模型和具体实现技术的解耦，Spring 在org.springframework.web.servlet 包中定义了一个高度抽象的 View接口。</p>
</li>
<li><p>视图对象由视图解析器负责实例化。由于视图是无状态的，所以他们不会有线程安全的问题。</p>
</li>
<li><p>常见的视图实现类</p>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210316173700.png"></p>
</li>
</ul>
<h2 id="6-2-视图解析器"><a href="#6-2-视图解析器" class="headerlink" title="6.2 视图解析器"></a>6.2 视图解析器</h2><ul>
<li><p>SpringMVC 为逻辑视图名的解析提供了不同的策略，可以在 Spring WEB 上下文中配置一种或多种解析策略，并指定他们之间的先后顺序。每一种映射策略对应一个具体的视图解析器实现类。 </p>
</li>
<li><p>视图解析器的作用比较单一：将逻辑视图解析为一个具体的视图对象。</p>
</li>
<li><p>所有的视图解析器都必须实现 ViewResolver 接口。</p>
</li>
<li><p>常用的视图解析器实现类：</p>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210316173913.png"></p>
</li>
<li><p>程序员可以选择一种视图解析器或混用多种视图解析器。</p>
</li>
<li><p>每个视图解析器都实现了 Ordered 接口并开放出一个 order 属性，可以通过 order 属性指定解析器的优先顺序，order 越小优先级越高。 </p>
</li>
<li><p>SpringMVC 会按视图解析器顺序的优先顺序对逻辑视图名进行解析，直到解析成功并返回视图对象，否则将抛出 ServletException 异 常。</p>
</li>
</ul>
<p><strong>InternalResourceViewResolver</strong></p>
<ul>
<li><p>JSP 是最常见的视图技术，可以使用InternalResourceViewResolver 作为视图解析器：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/views/&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>若项目中使用了 JSTL，则 SpringMVC 会自动把视图由InternalResourceView 转为 JstlView。配置不需要变。</p>
</li>
<li><p>若使用 JSTL 的 fmt 标签则需要在 SpringMVC 的配置文件中配置国际化资源文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置国际化资源--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;messageSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basename&quot;</span> <span class="attr">value</span>=<span class="string">&quot;i18n&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>若希望直接响应通过 SpringMVC 渲染的页面，可以使用 mvc:view-controller 标签实现</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置直接转发的页面：即直接访问/success就可以访问success页面，不需要经过controller层</span></span><br><span class="line"><span class="comment">    缺点：当配置了此配置后，success页面再通过controller层访问时会报错。</span></span><br><span class="line"><span class="comment">    解决方法是：配置mvc:annotation-driven标签--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/success&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;success&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>自定义视图解析器</strong></p>
<ul>
<li>自定义视图</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把此视图放到IOC容器中</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyView</span> <span class="keyword">implements</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getContentType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//返回视图类型。</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;text/html&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">render</span><span class="params">(Map&lt;String, ?&gt; model, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">//渲染视图</span></span><br><span class="line">    response.getWriter().append(<span class="string">&quot;&lt;h1&gt; hello world myView &lt;/h1&gt;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>配置视图解析器</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置BeanNameViewResolver视图解析器。用于解析指定视图名称的视图。从IOC中获取视图实例--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.BeanNameViewResolver&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--order为视图的优先级。值越小视图解析器的优先级就越高，越先解析--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>访问方式</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testview&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;asdas&quot;</span>);</span><br><span class="line">  <span class="comment">//指明要返回到哪个视图。首字母小写</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;myView&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Excel视图</strong></p>
<ul>
<li>若希望使用 Excel 展示数据列表，仅需要扩展SpringMVC 提供的 AbstractExcelView 或AbstractJExcel View 即可。实现 buildExcelDocument() 方法，在方法中使用模型数据对象构建 Excel 文档就可以了。</li>
<li>AbstractExcelView 基于 POI API，而AbstractJExcelView 是基于 JExcelAPI 的。</li>
<li>视图对象需要配置 IOC 容器中的一个 Bean，使用BeanNameViewResolver 作为视图解析器即可。</li>
<li>若希望直接在浏览器中直接下载 Excel 文档，则可以设置响应头 Content-Disposition 的值为attachment;filename=xxx.xls。</li>
</ul>
<h2 id="6-3-重定向和转发"><a href="#6-3-重定向和转发" class="headerlink" title="6.3 重定向和转发"></a>6.3 重定向和转发</h2><ul>
<li>一般情况下，控制器方法返回字符串类型的值会被当成逻辑视图名处理 。</li>
<li>如果返回的字符串中带 forward: 或 redirect: 前缀 时，SpringMVC 会对他们进行特殊处理：将 forward: 和<br>redirect: 当成指示符，其后的字符串作为 URL 来处理 。<ul>
<li>return = “redirect:/success.jsp”：会完成一个到 success.jsp 的重定向的操作。</li>
<li>return = “forward:success.jsp”：会完成一个到 success.jsp 的转发操作。</li>
</ul>
</li>
</ul>
<h1 id="第七章-表单标签和静态资源的处理"><a href="#第七章-表单标签和静态资源的处理" class="headerlink" title="第七章 表单标签和静态资源的处理"></a>第七章 表单标签和静态资源的处理</h1><ul>
<li>通过 SpringMVC 的表单标签可以实现将模型数据中的属性和 HTML 表单元素相绑定，以实现表单数据更便捷编辑和表单值的回显。</li>
</ul>
<h2 id="7-1-lt-form-form-gt-标签"><a href="#7-1-lt-form-form-gt-标签" class="headerlink" title="7.1 &lt;form:form&gt; 标签"></a>7.1 &lt;form:form&gt; 标签</h2><ul>
<li><p>一般情况下，通过 GET 请求获取表单页面，而通过POST 请求提交表单页面，因此获取表单页面和提交表单 页面的 URL 是相同的。只要满足该最佳条件的契约，&lt;form:form&gt; 标签就无需通过 action 属性指定表单提交的 URL</p>
</li>
<li><p>可以通过 modelAttribute 属性指定绑定的模型属性，若没有指定该属性，则默认从 request 域对象中读取command 的表单 bean，如果该属性值也不存在，则会 发生错误。</p>
</li>
<li><p>SpringMVC 提供了多个表单组件标签，如<a href="form:input/">form:input/</a>、<a href="form:select/">form:select/</a> 等，用以绑定表单字段的属性值，它们的共有属性如下：</p>
<ul>
<li>– path：表单字段，对应 html 元素的 name 属性，支持级联属性</li>
<li>– htmlEscape：是否对表单值的 HTML 特殊字符进行转换，默认值为 true</li>
<li>– cssClass：表单组件对应的 CSS 样式类名 </li>
<li>– cssErrorClass：表单组件的数据存在错误时，采取的 CSS 样式</li>
</ul>
</li>
<li><p>form:input、form:password、form:hidden、form:textarea：对应 HTML 表单的 text、password、hidden、textarea标签</p>
</li>
<li><p>form:radiobutton：单选框组件标签，当表单 bean 对应的属性值和 value 值相等时，单选框被选中 </p>
</li>
<li><p>form:radiobuttons：单选框组标签，用于构造多个单选框</p>
<ul>
<li>– items：可以是一个 List、String[] 或 Map</li>
<li>– itemValue：指定 radio 的 value 值。可以是集合中 bean 的一个属性值 </li>
<li>– itemLabel：指定 radio 的 label 值 </li>
<li>– delimiter：多个单选框可以通过 delimiter 指定分隔符</li>
</ul>
</li>
<li><p>form:checkbox：复选框组件。用于构造单个复选框 • form:checkboxs：用于构造多个复选框。使用方式同form:radiobuttons 标签</p>
</li>
<li><p>form:select：用于构造下拉框组件。使用方式同form:radiobuttons 标签</p>
</li>
<li><p>form:option：下拉框选项组件标签。使用方式同form:radiobuttons 标签</p>
</li>
<li><p>form:errors：显示表单组件或数据校验所对应的错误</p>
<ul>
<li> – &lt;form:errors path= “ *” /&gt; ：显示表单所有的错误</li>
<li>– &lt;form:errors path= “ user*” /&gt; ：显示所有以 user 为前缀的属性对应<br>的错误</li>
<li>– &lt;form:errors path= “ username” /&gt; ：显示特定表单对象属性的错误</li>
</ul>
</li>
<li><p>示例</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.HashMap&quot;</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.Map&quot;</span>%&gt;</span><br><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;form&quot;</span> uri=<span class="string">&quot;http://www.springframework.org/tags/form&quot;</span> %&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;!--  </span><br><span class="line">		<span class="number">1.</span> WHY 使用 form 标签呢 ?</span><br><span class="line">		可以更快速的开发出表单页面, 而且可以更方便的进行表单值的回显</span><br><span class="line">		<span class="number">2.</span> 注意:</span><br><span class="line">		可以通过 modelAttribute 属性指定绑定的模型属性,</span><br><span class="line">		若没有指定该属性，则默认从 request 域对象中读取 command 的表单 bean</span><br><span class="line">		如果该属性值也不存在，则会发生错误。</span><br><span class="line">	--&gt;</span><br><span class="line">	&lt;br&gt;&lt;br&gt;</span><br><span class="line">	&lt;form:form action=<span class="string">&quot;$&#123;pageContext.request.contextPath &#125;/emp&quot;</span> method=<span class="string">&quot;POST&quot;</span> </span><br><span class="line">		modelAttribute=<span class="string">&quot;employee&quot;</span>&gt;</span><br><span class="line">		&lt;form:errors path=&quot;*&quot;&gt;&lt;/form:errors&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;employee.id == null &#125;&quot;</span>&gt;</span><br><span class="line">			&lt;!-- path 属性对应 html 表单标签的 name 属性值 --&gt;</span><br><span class="line">			LastName: &lt;form:input path=<span class="string">&quot;lastName&quot;</span>/&gt;</span><br><span class="line">			&lt;form:errors path=&quot;lastName&quot;&gt;&lt;/form:errors&gt;</span><br><span class="line">		&lt;/c:if&gt;</span><br><span class="line">		&lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;employee.id != null &#125;&quot;</span>&gt;</span><br><span class="line">			&lt;form:hidden path=<span class="string">&quot;id&quot;</span>/&gt;</span><br><span class="line">			&lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_method&quot;</span> value=<span class="string">&quot;PUT&quot;</span>/&gt;</span><br><span class="line">			&lt;%-- 对于 _method 不能使用 form:hidden 标签, 因为 modelAttribute 对应的 bean 中没有 _method 这个属性 --%&gt;</span><br><span class="line">			&lt;%-- </span><br><span class="line">			&lt;form:hidden path=<span class="string">&quot;_method&quot;</span> value=<span class="string">&quot;PUT&quot;</span>/&gt;</span><br><span class="line">			--%&gt;</span><br><span class="line">		&lt;/c:if&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		Email: &lt;form:input path=<span class="string">&quot;email&quot;</span>/&gt;</span><br><span class="line">		&lt;form:errors path=&quot;email&quot;&gt;&lt;/form:errors&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;% </span><br><span class="line">			Map&lt;String, String&gt; genders = <span class="keyword">new</span> HashMap();</span><br><span class="line">			genders.put(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;Male&quot;</span>);</span><br><span class="line">			genders.put(<span class="string">&quot;0&quot;</span>, <span class="string">&quot;Female&quot;</span>);</span><br><span class="line">			</span><br><span class="line">			request.setAttribute(<span class="string">&quot;genders&quot;</span>, genders);</span><br><span class="line">		%&gt;</span><br><span class="line">		Gender: </span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;form:radiobuttons path=<span class="string">&quot;gender&quot;</span> items=<span class="string">&quot;$&#123;genders &#125;&quot;</span> delimiter=<span class="string">&quot;&lt;br&gt;&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		Department: &lt;form:select path=<span class="string">&quot;department.id&quot;</span> </span><br><span class="line">			items=&quot;$&#123;departments &#125;&quot; itemLabel=&quot;departmentName&quot; itemValue=&quot;id&quot;&gt;&lt;/form:select&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;!--  </span><br><span class="line">			<span class="number">1.</span> 数据类型转换</span><br><span class="line">			<span class="number">2.</span> 数据类型格式化</span><br><span class="line">			<span class="number">3.</span> 数据校验. </span><br><span class="line">			<span class="number">1</span>). 如何校验 ? 注解 ?</span><br><span class="line">			①. 使用 JSR <span class="number">303</span> 验证标准</span><br><span class="line">			②. 加入 hibernate validator 验证框架的 jar 包</span><br><span class="line">			③. 在 SpringMVC 配置文件中添加 &lt;mvc:annotation-driven /&gt;</span><br><span class="line">			④. 需要在 bean 的属性上添加对应的注解</span><br><span class="line">			⑤. 在目标方法 bean 类型的前面添加 <span class="meta">@Valid</span> 注解</span><br><span class="line">			<span class="number">2</span>). 验证出错转向到哪一个页面 ?</span><br><span class="line">			注意: 需校验的 Bean 对象和其绑定结果对象或错误对象时成对出现的，它们之间不允许声明其他的入参</span><br><span class="line">			<span class="number">3</span>). 错误消息 ? 如何显示, 如何把错误消息进行国际化</span><br><span class="line">		--&gt;</span><br><span class="line">		Birth: &lt;form:input path=<span class="string">&quot;birth&quot;</span>/&gt;</span><br><span class="line">		&lt;form:errors path=&quot;birth&quot;&gt;&lt;/form:errors&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		Salary: &lt;form:input path=<span class="string">&quot;salary&quot;</span>/&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Submit&quot;</span>/&gt;</span><br><span class="line">	&lt;/form:form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="7-2-处理静态资源"><a href="#7-2-处理静态资源" class="headerlink" title="7.2 处理静态资源"></a>7.2 处理静态资源</h2><ul>
<li><p>优雅的 REST 风格的资源URL 不希望带 .html 或 .do 等后缀 </p>
</li>
<li><p>若将 DispatcherServlet 请求映射配置为 /，则 Spring MVC 将捕获WEB 容器的所有请求，包括静态资源的请求， SpringMVC 会将他们当成一个普通请求处理，因找不到对应处理器将导致错误。 </p>
</li>
<li><p>可以在 SpringMVC 的配置文件中配置 &lt;mvc:default-servlet-handler/&gt; 的方式解决静态资源的问题： </p>
<ul>
<li> &lt;mvc:default-servlet-handler/&gt; 将在 SpringMVC 上下文中定义一个DefaultServletHttpRequestHandler，它会对进入 DispatcherServlet 的 请求进行筛查，如果发现是没有经过映射的请求，就将该请求交由 WEB 应用服务器默认的 Servlet 处理，如果不是静态资源的请求，才由DispatcherServlet 继续处理 </li>
<li>一般 WEB 应用服务器默认的 Servlet 的名称都是 default。若所使用的WEB 服务器的默认 Servlet 名称不是 default，则需要通过 default-servlet-name 属性显式指定</li>
</ul>
</li>
<li><p>操作</p>
<ul>
<li>注意js文件要位于：项目/web/scripts下</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--springmvc对静态资源的处理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:default-servlet-handler</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;script type=&quot;text/javascript&quot; src=&quot;scripts/jquery-1.9.1.min.js&quot;&gt;&lt;/script&gt;--&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="第八章-数据的转换，格式化，校验"><a href="#第八章-数据的转换，格式化，校验" class="headerlink" title="第八章 数据的转换，格式化，校验"></a>第八章 数据的转换，格式化，校验</h1><h2 id="8-1-数据绑定流程"><a href="#8-1-数据绑定流程" class="headerlink" title="8.1 数据绑定流程"></a>8.1 数据绑定流程</h2><ul>
<li><p>1.Spring MVC 主框架将 ServletRequest 对象及目标方法的入参实例传递给 WebDataBinderFactory 实例，以创 建 DataBinder 实例对象 。</p>
</li>
<li><p>2.DataBinder 调用装配在 Spring MVC 上下文中的ConversionService 组件进行数据类型转换、数据格式化工作。将 Servlet 中的请求信息填充到入参对象中。</p>
</li>
<li><p>3.调用 Validator 组件对已经绑定了请求消息的入参对象 进行数据合法性校验，并最终生成数据绑定结果BindingData 对象 。</p>
</li>
<li><p>4.Spring MVC 抽取 BindingResult 中的入参对象和校验错误对象，将它们赋给处理方法的响应入参。</p>
</li>
<li><p>Spring MVC 通过反射机制对目标处理方法进行解析，将请求消息绑定到处理方法的入参中。数据绑定的核心部件是DataBinder，运行机制如下：</p>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210318134325.png"></p>
</li>
</ul>
<h2 id="8-2-数据转换"><a href="#8-2-数据转换" class="headerlink" title="8.2 数据转换"></a>8.2 数据转换</h2><ul>
<li><p>Spring MVC 上下文中内建了很多转换器，可完成大多数 Java 类型的转换工作。</p>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210317205109.png"></p>
</li>
<li><p>自动以类型转换器</p>
<ul>
<li>ConversionService 是 Spring 类型转换体系的核心接口。</li>
<li>可以利用 ConversionServiceFactoryBean 在 Spring 的 IOC 容器中定义一个 ConversionService。Spring 将自动识别出IOC 容器中的 ConversionService，并在 Bean 属性配置及Spring MVC 处理方法入参绑定等场合使用它进行数据的转换</li>
<li>可通过 ConversionServiceFactoryBean 的 converters 属性注册自定义的类型转换器</li>
<li>Spring 定义了 3 种类型的转换器接口，实现任意一个转换器接口都可以作为自定义转换器注册到ConversionServiceFactroyBean 中：<ul>
<li>Converter&lt;S,T&gt;：将 S 类型对象转为 T 类型对象 。</li>
<li>ConverterFactory：将相同系列多个 “同质” Converter 封装在一起。如果希望将一种类型的对象转换为另一种类型及其子类的对象（例如将 String 转换为 Number 及 Number 子类 （Integer、Long、Double 等）对象）可使用该转换器工厂类 。</li>
<li>GenericConverter：会根据源类对象及目标类对象所在的宿主类 中的上下文信息进行类型转换。</li>
</ul>
</li>
</ul>
</li>
<li><p>使用方式：</p>
<ul>
<li>例如前端传递lastname-email-gender-department.id格式的字符串，例如GG-<a href="mailto:&#103;&#x67;&#64;&#x61;&#x74;&#x67;&#117;&#x69;&#103;&#117;&#46;&#99;&#111;&#x6d;&#45;&#48;&#x2d;&#49;&#x30;&#53;">&#103;&#x67;&#64;&#x61;&#x74;&#x67;&#117;&#x69;&#103;&#117;&#46;&#99;&#111;&#x6d;&#45;&#48;&#x2d;&#49;&#x30;&#53;</a></li>
<li>转化到后台时为Employee对象。</li>
<li>配置文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">conversion-service</span>=<span class="string">&quot;conversionService2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置ConversionService--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.context.support.ConversionServiceFactoryBean&quot;</span> <span class="attr">id</span>=<span class="string">&quot;conversionService2&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;converters&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;employeeConverter&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>自定义的转换器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">String</span>,<span class="title">Employee</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Employee <span class="title">convert</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">    Employee employee = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (s != <span class="keyword">null</span>)&#123;</span><br><span class="line">      String[] values = s.split(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (values != <span class="keyword">null</span> &amp;&amp; values.length == <span class="number">4</span>)&#123;</span><br><span class="line">        String lastName = values[<span class="number">0</span>];</span><br><span class="line">        String email = values[<span class="number">1</span>];</span><br><span class="line">        Integer gender = Integer.parseInt(values[<span class="number">2</span>]);</span><br><span class="line">        Department department = <span class="keyword">new</span> Department();</span><br><span class="line">        department.setId(Integer.parseInt(values[<span class="number">3</span>]));</span><br><span class="line">        employee = <span class="keyword">new</span> Employee(<span class="keyword">null</span>,lastName,email, gender,department);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> employee;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>其他代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&lt;form action=&quot;$&#123;pageContext.request.contextPath&#125;/testconverter&quot; &gt;</span></span><br><span class="line"><span class="comment">  输入：&lt;input type=&quot;text&quot; name=&quot;employee&quot;&gt;</span></span><br><span class="line"><span class="comment">  &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span></span><br><span class="line"><span class="comment">&lt;/form&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/testconverter&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testConcerter</span><span class="params">(<span class="meta">@RequestParam(&quot;employee&quot;)</span> Employee employee)</span></span>&#123;</span><br><span class="line">  System.out.println(employee.toString());</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="8-3-关于-lt-mvc-annotation-driven-gt-配置"><a href="#8-3-关于-lt-mvc-annotation-driven-gt-配置" class="headerlink" title="8.3 关于&lt;mvc:annotation-driven/&gt;配置"></a>8.3 关于&lt;mvc:annotation-driven/&gt;配置</h2><ul>
<li>&lt;mvc:annotation-driven /&gt; 会自动注 册RequestMappingHandlerMapping、RequestMappingHandlerAdapter 与ExceptionHandlerExceptionResolver 三个bean。 </li>
<li>还将提供以下支持：<ul>
<li>支持使用 ConversionService 实例对表单参数进行类型转换</li>
<li>支持使用 @NumberFormat annotation、@DateTimeFormat注解完成数据类型的格式化</li>
<li>支持使用 @Valid 注解对 JavaBean 实例进行 JSR 303 验证</li>
<li>支持使用 @RequestBody 和 @ResponseBody 注解</li>
</ul>
</li>
<li><strong>实际开发中都会配置这个标签。</strong></li>
<li>目前使用此配置的时候<ul>
<li>第一：配置&lt;mvc:view-controller/&gt;时需要添加此配置，保证页面能正常跳转。</li>
<li>第二：配置&lt;mvc:default-servlet-handler/&gt;时需要添加此配置，保证静态资源能正常使用。</li>
<li>第三：使用自定义类型转换器时，需要添加此配置，以将自定义类型转换器添加到系统中。</li>
</ul>
</li>
</ul>
<h2 id="8-4-InitBinder注解"><a href="#8-4-InitBinder注解" class="headerlink" title="8.4 @InitBinder注解"></a>8.4 @InitBinder注解</h2><ul>
<li> @InitBinder 标识的方法，可以对 WebDataBinder 对 象进行初始化。WebDataBinder 是 DataBinder 的子类，用于完成由<strong>表单字段到 JavaBean 属性</strong>的绑定 。</li>
<li>@InitBinder方法不能有返回值，它必须声明为void。 </li>
<li>@InitBinder方法的参数通常是是 WebDataBinder。</li>
<li>示例</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 作用：当请求的参数绑定为Employee类的对象时，对于lastName属性不绑定</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> webDataBinder</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"><span class="meta">@InitBinder</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initBinder</span><span class="params">(WebDataBinder webDataBinder)</span></span>&#123;</span><br><span class="line">  webDataBinder.setDisallowedFields(<span class="string">&quot;lastName&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-5-数据格式化"><a href="#8-5-数据格式化" class="headerlink" title="8.5 数据格式化"></a>8.5 数据格式化</h2><ul>
<li>对属性对象的输入/输出进行格式化，从其本质上讲依然属于 “类型转换” 的范畴。</li>
<li>Spring 在格式化模块中定义了一个实现ConversionService 接口的FormattingConversionService 实现类，该实现类扩展 了 GenericConversionService，因此它既具有类型转换的功能，又具有格式化的功能。</li>
<li>FormattingConversionService 拥有一个FormattingConversionServiceFactroyBean 工厂类，后者用于在 Spring 上下文中构造前者。</li>
<li>FormattingConversionServiceFactroyBean 内部已经注册了 : <ul>
<li>NumberFormatAnnotationFormatterFactroy：支持对数字类型的属性使用 @NumberFormat 注解</li>
<li>JodaDateTimeFormatAnnotationFormatterFactroy：支持对日期类型的属性使用 @DateTimeFormat 注解</li>
</ul>
</li>
<li>装配了 FormattingConversionServiceFactroyBean 后，就可以在 Spring MVC 入参绑定及模型数据输出时使用注解驱动了。&lt;mvc:annotation-driven/&gt; 默认创建的ConversionService 实例即为FormattingConversionServiceFactroyBean。</li>
<li>注意：<ul>
<li>当使用以下注解时，&lt;mvc:annotation-driven /&gt;注解中不能添加任何属性，比如自定义的类型转换器。</li>
<li>如果一定添加自定义类型转换器。那么ConversionService的class要由ConversionServiceFactoryBean变成FormattingConversionServiceFactroyBean 。</li>
</ul>
</li>
</ul>
<p><strong>日期格式化</strong></p>
<ul>
<li>@DateTimeFormat 注解可对java.util.Date、java.util.Calendar、java.long.Long 时间类型进行标注： <ul>
<li>pattern 属性：类型为字符串。指定解析/格式化字段数据的模式，如：”yyyy-MM-dd hh:mm:ss” 。</li>
<li> iso 属性：类型为 DateTimeFormat.ISO。指定解析/格式化字段数据的ISO模式，包括四种：ISO.NONE（不使用） ，默 认ISO.DATE(yyyy-MM-dd) 、ISO.TIME(hh:mm:ss.SSSZ)、ISO.DATE_TIME(yyyy-MM-dd hh:mm:ss.SSSZ) </li>
<li>style 属性：字符串类型。通过样式指定日期时间的格式，由两位字符组成，第一位表示日期的格式，第二位表示时间的格式：S：短日期/时间格式、M：中日期/时间格式、L：长日期/时间格式、F：完整日期/时间格式、-：忽略日期或时间格式。</li>
</ul>
</li>
<li>示例</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">页面代码为</span></span><br><span class="line"><span class="comment">Birth：&lt;form:input path=&quot;birth&quot; /&gt;</span></span><br><span class="line"><span class="comment">输入：1992-1-1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@DateTimeFormat(pattern=&quot;yyyy-MM-dd&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Date birth;</span><br></pre></td></tr></table></figure>

<p><strong>数值格式化</strong></p>
<ul>
<li>@NumberFormat 可对类似数字类型的属性进行标 注，它拥有两个<strong>互斥</strong>的属性：<ul>
<li>style：类型为 NumberFormat.Style。用于指定样式类型，包括三种：Style.NUMBER（正常数字类型）、Style.CURRENCY（货币类型）、 Style.PERCENT（百分数类型）</li>
<li>pattern：类型为 String，自定义样式，如patter=”#,###”；</li>
</ul>
</li>
<li>示例</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">页面代码为</span></span><br><span class="line"><span class="comment">Salary：&lt;form:input path=&quot;salary&quot;/&gt;</span></span><br><span class="line"><span class="comment">输入：1,123.5</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@NumberFormat(pattern=&quot;#,###.#&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Float salary;</span><br></pre></td></tr></table></figure>

<h2 id="8-6-数据校验"><a href="#8-6-数据校验" class="headerlink" title="8.6 数据校验"></a>8.6 数据校验</h2><p><strong>JSR 303</strong></p>
<ul>
<li><p>JSR 303 是 Java 为 Bean 数据合法性校验提供的标准框架，它已经包含在 JavaEE 6.0 中 .</p>
</li>
<li><p>JSR 303 通过在 Bean 属性上标注类似于 @NotNull、@Max 等标准的注解指定校验规则，并通过标准的验证接口对 Bean 进行验证。</p>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210317213832.png"></p>
</li>
</ul>
<p><strong>Hibernate Validator 扩展注解</strong></p>
<ul>
<li><p>Hibernate Validator 是 JSR 303 的一个参考实现，除支持所有标准的校验注解外，它还支持以下的扩展注解。</p>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210317213909.png"></p>
</li>
</ul>
<p><strong>Spring MVC数据校验</strong></p>
<ul>
<li><p>Spring 4.0 拥有自己独立的数据校验框架，同时支持 JSR 303 标准的校验框架。</p>
</li>
<li><p>Spring 在进行数据绑定时，可同时调用校验框架完成数据校验工作。在 Spring MVC 中，可直接通过注解驱动的方式进行数据校验 。</p>
</li>
<li><p>Spring 的 LocalValidatorFactroyBean 既实现了 Spring 的Validator 接口，也实现了 JSR 303 的 Validator 接口。只要在 Spring 容器中定义了一个LocalValidatorFactoryBean，即可将其注入到需要数据校验的 Bean 中。</p>
</li>
<li><p>Spring 本身并没有提供 JSR303 的实现，所以必须将JSR303 的实现者的 jar 包放到类路径下。</p>
<ul>
<li>hibernate-validator-5.0.0.CR2.jar：<a target="_blank" rel="noopener" href="https://plumriver.lanzous.com/iAB8On1jf1e">下载</a></li>
<li>hibernate-validator-annotation-processor-5.0.0.CR2.jar：<a target="_blank" rel="noopener" href="https://plumriver.lanzous.com/iyTKfn1jf2f">https://plumriver.lanzous.com/iyTKfn1jf2f</a></li>
</ul>
</li>
<li><p>&lt;mvc:annotation-driven/&gt; 会默认装配好一个LocalValidatorFactoryBean，通过在处理方法的入参上标 注 @valid 注解即可让 Spring MVC 在完成数据定后执行数据校验的工作。</p>
</li>
<li><p>在已经标注了 JSR303 注解的表单/命令对象前标注一个@Valid，Spring MVC 框架在将请求参数绑定到该入参对象后，就会调用校验框架根据注解声明的校验规则实施校验 。</p>
</li>
<li><p>示例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实体类</span></span><br><span class="line"><span class="meta">@NotEmpty</span></span><br><span class="line"><span class="keyword">private</span> String lastName;</span><br><span class="line"><span class="meta">@Email</span></span><br><span class="line"><span class="keyword">private</span> String email;</span><br><span class="line"><span class="comment">//控制层方法，添加@Valid注解</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;emp&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">(<span class="meta">@Valid</span> Employee employee)</span></span>&#123;</span><br><span class="line">  employeeDao.save(employee);</span><br><span class="line">  System.out.println(<span class="string">&quot;asdasd&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;redirect:/emps&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Spring MVC 是通过对处理方法签名的规约来保存校验结果的：前一个表单/命令对象的校验结果保存到随后的入参中，这个保存校验结果的入参必须是 BindingResult 或Errors 类型，这两个类都位于org.springframework.validation 包中。</p>
</li>
<li><p><font color="red">需校验的 Bean 对象和其绑定结果对象或错误对象时成对出现的，它们之间不允许声明其他的入参。</font></p>
</li>
<li><p>Errors 接口提供了获取错误信息的方法，如 getErrorCount() 或getFieldErrors(String field) </p>
</li>
<li><p>BindingResult 扩展了 Errors 接口</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;emp&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">(<span class="meta">@Valid</span> Employee employee, BindingResult result)</span></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (result.getErrorCount() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;出错了&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (FieldError fieldError : result.getFieldErrors()) &#123;</span><br><span class="line">      System.out.println(fieldError.getField() + <span class="string">&quot; : &quot;</span> + fieldError.getDefaultMessage());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在表单/命令对象类的属性中标注校验注解，在处理方法对 应的入参前添加 @Valid，Spring MVC 就会实施校验并将校验结果保存在被校验入参对象之后的 BindingResult 或Errors 入参中。</li>
<li>常用方法：<ul>
<li>– FieldError getFieldError(String field)</li>
<li>– List&lt;FieldError&gt; getFieldErrors()</li>
<li>– Object getFieldValue(String field)</li>
<li>– Int getErrorCount()</li>
</ul>
</li>
</ul>
<p><strong>在页面上显示错误</strong></p>
<ul>
<li>Spring MVC 除了会将表单/命令对象的校验结果保存到对 应的 BindingResult 或 Errors 对象中外，还会将所有校验 结果保存到 “隐含模型” </li>
<li>即使处理方法的签名中没有对应于表单/命令对象的结果入参，校验结果也会保存在 “隐含对象” 中。</li>
<li>隐含模型中的所有数据最终将通过 HttpServletRequest 的属性列表暴露给 JSP 视图对象，因此在 JSP 中可以获取错误信息</li>
<li>在 JSP 页面上可通过 &lt;form:errors path=“userName”&gt; 显示错误消息。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Email: &lt;form:input path&#x3D;&quot;email&quot;&#x2F;&gt;</span><br><span class="line">&lt;form:errors path&#x3D;&quot;email&quot;&gt;&lt;&#x2F;form:errors&gt;</span><br></pre></td></tr></table></figure>

<p><strong>提示消息的国际化</strong></p>
<ul>
<li>每个属性在数据绑定和数据校验发生错误时，都会生成一个对应的 FieldError 对象。</li>
<li>当一个属性校验失败后，校验框架会为该属性生成 4 个消息代码，这些代码以校验注解类名为前缀，结合modleAttribute、属性名及属性类型名生成多个对应的消息代码：例如 User 类中的 password 属性标准了一个 @Pattern 注解，当该属性值不满足 @Pattern 所定义的规则时, 就会产生以下 4 个错误代码： <ul>
<li>– Pattern.user.password</li>
<li>– Pattern.password</li>
<li>– Pattern.java.lang.String</li>
<li>– Pattern</li>
</ul>
</li>
<li>当使用 Spring MVC 标签显示错误消息时， Spring MVC 会查看WEB 上下文是否装配了对应的国际化消息，如果没有，则显示默认 的错误消息，否则使用国际化消息。</li>
<li>若数据类型转换或数据格式转换时发生错误，或该有的参数不存在，或调用处理方法时发生错误，都会在隐含模型中创建错误消息。其错误代码前缀说明如下：<ul>
<li>– required：必要的参数不存在。如 @RequiredParam(“param1”) 标注了一个入参，但是该参数不存在</li>
<li>– typeMismatch：在数据绑定时，发生数据类型不匹配的问题</li>
<li>– methodInvocation：Spring MVC 在调用处理方法时发生了错误</li>
</ul>
</li>
<li>注册国际化资源文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置国际化资源--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;messageSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basename&quot;</span> <span class="attr">value</span>=<span class="string">&quot;i18n&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>文件</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">NotEmpty.employee.lastName</span>=<span class="string">填写的LastName为空</span></span><br><span class="line"><span class="meta">Email..employee.email</span>=<span class="string">填写的Email不符合邮箱格式</span></span><br><span class="line"></span><br><span class="line"><span class="meta">typeMismatch.employee.birth</span>=<span class="string">填写的Birth不是一个日期</span></span><br></pre></td></tr></table></figure>

<h1 id="第九章-JSON"><a href="#第九章-JSON" class="headerlink" title="第九章 JSON"></a>第九章 JSON</h1><ul>
<li><p>使用方式：</p>
<ul>
<li>第一步：添加jsr包<ul>
<li>jackson-core-2.1.5.jar：<a target="_blank" rel="noopener" href="https://plumriver.lanzous.com/ilAHjn1w51c">下载</a></li>
<li>jackson-databind-2.1.5.jar：<a target="_blank" rel="noopener" href="https://plumriver.lanzous.com/il7Mpn1w52d">下载</a></li>
<li>jackson-annotations-2.1.5.jar：<a target="_blank" rel="noopener" href="https://plumriver.lanzous.com/iOZLEn1w4za">下载</a></li>
</ul>
</li>
<li>第二步：编写目标方法，使其返回JSON对应的对象和集合。</li>
<li>第三步：再目标方法上添加@ResponseBody注解</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@ResponseBody表示将返回值转换为Json格式传递到前页面。</span></span><br><span class="line"><span class="comment">//转换后如下：&#123;&quot;id&quot;:1001,&quot;lastName&quot;:&quot;E-AA&quot;,&quot;email&quot;:&quot;aa@163.com&quot;,&quot;gender&quot;:1,&quot;department&quot;:&#123;&quot;id&quot;:101,&quot;departmentName&quot;:&quot;D-AA&quot;&#125;,&quot;birth&quot;:null,&quot;salary&quot;:null&#125;</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;testJson&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Employee <span class="title">testJson</span><span class="params">()</span></span>&#123;</span><br><span class="line">  Employee employee = employeeDao.get(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span>  employee;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>HttpMessageConverter&lt;T&gt; 是 Spring3.0 新添加的一个接口，负责将请求信息转换为一个对象（类型为 T），将对象（类型为 T）输出为响应信息</p>
</li>
<li><p>HttpMessageConverter&lt;T&gt;接口定义的方法： </p>
<ul>
<li>Boolean canRead(Class&lt;?&gt; clazz,MediaType mediaType): 指定转换器可以读取的对象类型，即转换器是否可将请求信息转换为 clazz 类型的对象，同时指定支持 MIME 类型(text/html,applaiction/json等) </li>
<li>Boolean canWrite(Class&lt;?&gt; clazz,MediaType mediaType):指定转换器是否可将 clazz 类型的对象写到响应流中，响应流支持的媒体类型 在MediaType 中定义。 </li>
<li>LIst&lt;MediaType&gt; getSupportMediaTypes()：该转换器支持的媒体类型。</li>
<li>T read(Class&lt;? extends T&gt; clazz,HttpInputMessage inputMessage)： 将请求信息流转换为 T 类型的对象。</li>
<li>void write(T t,MediaType contnetType,HttpOutputMessgaeoutputMessage):将T类型的对象写到响应流中，同时指定相应的媒体类 型为 contentType。</li>
</ul>
</li>
<li><p>HttpMessageConverter&lt;T&gt; 的实现原理：</p>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210318100613.png"></p>
</li>
<li><p>HttpMessageConverter&lt;T&gt; 的实现类：</p>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210318100617.png"></p>
</li>
<li><p>DispatcherServlet 默认装配RequestMappingHandlerAdapter ，而RequestMappingHandlerAdapter在加入jackson jar包后，会装配jackson jar包中的转换器。</p>
</li>
<li><p>使用 HttpMessageConverter&lt;T&gt; 将请求信息转化并绑定到处理方法的入参中或将响应结果转为对应类型的响应信息，Spring 提供了两种途径： </p>
<ul>
<li>使用 @RequestBody / @ResponseBody 对处理方法进行标注 。</li>
<li>使用 HttpEntity&lt;T&gt; / ResponseEntity&lt;T&gt; 作为处理方法的入参或返回值。</li>
</ul>
</li>
<li><p>当控制器处理方法使用到 @RequestBody/@ResponseBody 或HttpEntity&lt;T&gt;/ResponseEntity&lt;T&gt; 时, Spring 首先根据请求头或响应头的Accept 属性选择匹配的 HttpMessageConverter, 进而根据参数类型或泛型类型的过滤得到匹配的 HttpMessageConverter, 若找不到可用的HttpMessageConverter 将报错。</p>
</li>
<li><p>@RequestBody 和 @ResponseBody 不需要成对出现。</p>
</li>
<li><p>示例：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/testJson&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Employee <span class="title">testJson</span><span class="params">()</span></span>&#123;</span><br><span class="line">  Employee employee = employeeDao.get(<span class="number">1001</span>);</span><br><span class="line">  System.out.println(employee);</span><br><span class="line">  <span class="keyword">return</span> employee;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/testJson2&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String  <span class="title">testJson2</span><span class="params">(<span class="meta">@RequestBody</span> Employee employee)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/testJson3&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String  <span class="title">testJson3</span><span class="params">(HttpEntity&lt;Employee&gt; entity)</span></span>&#123;</span><br><span class="line">  <span class="comment">//获取请求头的内容长度</span></span><br><span class="line">  System.out.println(entity.getHeaders().getContentLength());</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/testJson4&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;<span class="keyword">byte</span>[]&gt; testJson4() <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">  Resource resource = <span class="keyword">new</span> ClassPathResource(<span class="string">&quot;/abc.jpg&quot;</span>);</span><br><span class="line">  <span class="keyword">byte</span>[] fileDate = FileCopyUtils.copyToByteArray(resource.getInputStream());</span><br><span class="line">  ResponseEntity&lt;<span class="keyword">byte</span>[]&gt; responseEntity = <span class="keyword">new</span> ResponseEntity&lt;<span class="keyword">byte</span>[]&gt;(fileDate, HttpStatus.OK);</span><br><span class="line">  <span class="keyword">return</span> responseEntity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>总结：一般情况下我们只会使用@ResponseBody和Ajax进行协调使用。</li>
</ul>
<h1 id="第十章-国际化处理"><a href="#第十章-国际化处理" class="headerlink" title="第十章 国际化处理"></a>第十章 国际化处理</h1><ul>
<li><p>默认情况下，SpringMVC 根据 Accept-Language 参数判断客户端的本地化类型。</p>
</li>
<li><p>当接受到请求时，SpringMVC 会在上下文中查找一个本地化解析器（LocalResolver），找到后使用它获取请求 所对应的本地化类型信息。</p>
</li>
<li><p>SpringMVC 还允许装配一个动态更改本地化类型的拦截 器，这样通过指定一个请求参数就可以控制单个请求的本地化类型。</p>
</li>
<li><p>AcceptHeaderLocaleResolver：根据 HTTP 请求头的Accept-Language 参数确定本地化类型，如果没有显式定义本地化解析器， SpringMVC 使用该解析器。</p>
<ul>
<li>CookieLocaleResolver：根据指定的 Cookie 值确定本地化类 型 </li>
<li>SessionLocaleResolver：根据 Session 中特定的属性确定本地化类型 </li>
<li>LocaleChangeInterceptor：从请求参数中获取本次请求对应的本地化类型</li>
</ul>
</li>
<li><p>注意：访问的第一个index.jsp中不能使用国际化，转发后的页面才可以使用国际化配置。</p>
</li>
<li><p>使用步骤：</p>
<ul>
<li>第一步：在springmvc配置文件中配置国际化资源包</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置国际化资源--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;messageSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basename&quot;</span> <span class="attr">value</span>=<span class="string">&quot;i18n&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>第二步：编写国际化资源</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># i18n.properties 默认加载的国际化资源文件</span></span><br><span class="line"><span class="meta">i18n.username</span>=<span class="string">username</span></span><br><span class="line"><span class="meta">i18n.password</span>=<span class="string">password</span></span><br><span class="line"><span class="comment"># i18n_en_US.properties 英文的国际化资源文件</span></span><br><span class="line"><span class="meta">i18n.username</span>=<span class="string">username</span></span><br><span class="line"><span class="meta">i18n.password</span>=<span class="string">password</span></span><br><span class="line"><span class="comment"># i18n_zh_CN.properties 中文的国际化资源文件</span></span><br><span class="line"><span class="meta">i18n.username</span>=<span class="string">用户</span></span><br><span class="line"><span class="meta">i18n.password</span>=<span class="string">密码</span></span><br></pre></td></tr></table></figure>

<ul>
<li>第三步：前端页面引用</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;fmt&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/fmt&quot;</span> %&gt;</span><br><span class="line">&lt;%--fmt标签需要引入--%&gt;</span><br><span class="line">&lt;fmt:message key=&quot;i18n.username&quot; &gt;&lt;/fmt:message&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;fmt:message key=&quot;i18n.password&quot;&gt;&lt;/fmt:message&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>实现页面跳转时在控制层获取国际化资源中i18n.username对应的信息</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ResourceBundleMessageSource messageSource;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/i18n&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testI18n</span><span class="params">(Locale locale)</span></span>&#123;</span><br><span class="line">  String val = messageSource.getMessage(<span class="string">&quot;i18n.user&quot;</span>,<span class="keyword">null</span>,locale);</span><br><span class="line">  System.out.println(val);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;i18n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>实现通过超链接更改页面语言，而不用通过浏览器设置。</p>
<ul>
<li>第一步：在springmvc配置文件中配置国际化的解析器和拦截器</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置解析器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.i18n.SessionLocaleResolver&quot;</span> <span class="attr">id</span>=<span class="string">&quot;localeResolver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置拦截器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.i18n.LocaleChangeInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>第二步：在超链接上添加local属性值。</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--i18n表示要访问的页面请求--&gt;</span><br><span class="line">&lt;a href=&quot;i18n?locale=zh_CN&quot;&gt;中文&lt;/a&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;a href=&quot;i18n?locale=en_US&quot;&gt;英文&lt;/a&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="第十一章-文件的上传"><a href="#第十一章-文件的上传" class="headerlink" title="第十一章 文件的上传"></a>第十一章 文件的上传</h1><ul>
<li><p>Spring MVC 为文件上传提供了直接的支持，这种支持是通过即插即用的 MultipartResolver 实现的。Spring 用Jakarta Commons FileUpload 技术实现了一个MultipartResolver 实现类：CommonsMultipartResovler</p>
</li>
<li><p>Spring MVC 上下文中默认没有装配 MultipartResovler，因此默认情况下不能处理文件的上传工作，如果想使用 Spring 的文件上传功能，需现在配置文件中中配置 MultipartResolver。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置文件上传--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;defaultEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--以字节kb为单位--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxUploadSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1024000&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>defaultEncoding: 必须和用户 JSP 的 pageEncoding 属性一致，以便正确解析表单的内容</p>
</li>
<li><p>为了让 CommonsMultipartResovler 正确工作，必须先 将 Jakarta Commons FileUpload 及 Jakarta Commons io的类包添加到类路径下。</p>
<ul>
<li>commons-fileupload-1.2.1.jar：<a target="_blank" rel="noopener" href="https://plumriver.lanzous.com/iK0wcm3uhob">下载</a></li>
<li>commons-io-2.0.jar：<a target="_blank" rel="noopener" href="https://plumriver.lanzous.com/isPGVm3uqkb">下载</a></li>
</ul>
</li>
<li><p>示例：</p>
<ul>
<li>前端代码</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;testFileload&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">  file：&lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file&quot;</span>&gt;</span><br><span class="line">  &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;上传&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>控制层处理方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testFileload&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFileload</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span>MultipartFile file)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">  InputStream inputStream = file.getInputStream();</span><br><span class="line">  file.getName();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="第十二章-拦截器"><a href="#第十二章-拦截器" class="headerlink" title="第十二章 拦截器"></a>第十二章 拦截器</h1><ul>
<li><p>Spring MVC也可以使用拦截器对请求进行拦截处理，用户可以自定义拦截器来实现特定的功能，自定义的拦截器必须实现HandlerInterceptor接口</p>
<ul>
<li>preHandle()：这个方法在业务处理器处理请求之前被调用，在该方法中对用户请求 request 进行处理。<ul>
<li>如果程序员决定该拦截器对 请求进行拦截处理后还要调用其他的拦截器，或者是业务处理器去进行处理，则返回true；</li>
<li>如果程序员决定不需要再调用其他的组件 去处理请求，则返回false。 </li>
</ul>
</li>
<li>postHandle()：这个方法在业务处理器处理完请求后，但是DispatcherServlet 向客户端返回响应前被调用，在该方法中对 用户请求request进行处理。 </li>
<li>afterCompletion()：这个方法在 DispatcherServlet 完全处理完请求后被调用，可以在该方法中进行一些资源清理的操作。</li>
</ul>
</li>
<li><p>示例</p>
<ul>
<li>自定义拦截器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;接受请求前&quot;</span>);</span><br><span class="line">    <span class="comment">//常用来权限管理，事务，日志，请求和响应的字符格式</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;响应请求后，渲染视图前&quot;</span>);</span><br><span class="line">    <span class="comment">//可以用来修改请求域的属性或视图</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;渲染视图后&quot;</span>);</span><br><span class="line">    <span class="comment">//常用来释放资源</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>将自定义拦截器配置到springmvc中</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置解析器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.i18n.SessionLocaleResolver&quot;</span> <span class="attr">id</span>=<span class="string">&quot;localeResolver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--配置拦截器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--配置自定义拦截器，拦截所有请求--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.lc.interceptor.FirstInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--配置自定义拦截器，拦截指定请求--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/emps&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.lc.interceptor.FirstInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--配置自定义拦截器，拦截所有请求，但不拦截指定请求--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--这个必须写在前面，需要先指定拦截哪些请求，然后再剔除--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/*&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:exclude-mapping</span> <span class="attr">path</span>=<span class="string">&quot;/emp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.lc.interceptor.FirstInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>多个拦截器的使用顺序(默认按照在springmvc配置文件中的顺序执行)</p>
<ul>
<li>第一：多个拦截器的preHandle()都返回true。<ul>
<li>先顺序执行拦截器的preHandle()方法，在逆序执行postHandle()方法，再逆序执行afterCompletion()方法。</li>
</ul>
</li>
<li>第二：第一个拦截器的preHandle()返回false。<ul>
<li>只执行第一个拦截器的preHandle()方法，其他的都不执行。</li>
</ul>
</li>
<li>第三：有一个拦截器的preHandle()返回false。<ul>
<li>先执行在这个拦截器之前注册的拦截器的preHandle()方法，在执行这个拦截器的preHandle()方法。最后逆序执行在这个拦截器之前注册的拦截器的afterCompletion()方法。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="第十三章-异常处理"><a href="#第十三章-异常处理" class="headerlink" title="第十三章 异常处理"></a>第十三章 异常处理</h1><ul>
<li>Spring MVC 通过 HandlerExceptionResolver 处理程序的异常，包括 Handler 映射、数据绑定以及目标方法执行时发生的异常。 </li>
<li>SpringMVC 提供的 HandlerExceptionResolver 的实现类。</li>
<li>使用异常处理时，需要添加&lt;mvc:annotation-driven/&gt; 配置。</li>
</ul>
<p><strong>ExceptionHandlerExceptionResolver异常处理解析器</strong></p>
<ul>
<li>作用：主要处理 Handler 中用 @ExceptionHandler 注解定义的方法。 </li>
<li>@ExceptionHandler 注解定义的方法优先级问题：例如发生的是NullPointerException，但是声明的异常有<br>RuntimeException 和 Exception，此候会根据异常的最近继承关系找到继承深度最浅的那个 @ExceptionHandler注解方法，即标记了 RuntimeException 的方法。</li>
<li>注意：异常处理方法只能处理方法所在类中发生的异常，无法处理全局的异常。</li>
<li>示例</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 1,方法的参数为Exception时，传入的e是异常对象</span></span><br><span class="line"><span class="comment">   * 2.<span class="doctag">@ExceptionHandler</span>注解的值是一个数组，值是要处理的异常的类</span></span><br><span class="line"><span class="comment">   * 3.如果要将异常信息放到页面上,需要使用ModelAndView作为返回值才可以</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> e</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"><span class="meta">@ExceptionHandler(&#123;RuntimeException.class&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handException</span><span class="params">(Exception e)</span></span>&#123;</span><br><span class="line">  System.out.println(e);</span><br><span class="line">  ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  modelAndView.addObject(<span class="string">&quot;exception&quot;</span>, e);</span><br><span class="line">  <span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ExceptionHandlerMethodResolver 内部若找不到@ExceptionHandler 注解的话，会找 @ControllerAdvice 中的@ExceptionHandler 注解方法。</li>
<li>即：若是出现异常时，在本类中找不到异常处理方法，则在springmvc中找注解为@ControllerAdvice 的类，然后找这个类中带@ExceptionHandler 注解的方法。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstExceptionHandle</span> </span>&#123;</span><br><span class="line">  <span class="meta">@ExceptionHandler(&#123;RuntimeException.class&#125;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handException</span><span class="params">(Exception e)</span></span>&#123;</span><br><span class="line">    System.out.println(e);</span><br><span class="line">    ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    modelAndView.addObject(<span class="string">&quot;exception&quot;</span>, e);</span><br><span class="line">    <span class="keyword">return</span> modelAndView;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ResponseStatusExceptionResolver异常状态解析器</strong></p>
<ul>
<li>作用：解析异常发生后要发送的状态码。</li>
<li>@ResponseStatus 注解用于修饰自定义异常类。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//value为发生异常时返回的状态码，reason为需要在页面显示的信息</span></span><br><span class="line"><span class="meta">@ResponseStatus(value = HttpStatus.UNAUTHORIZED,reason = &quot;输入数据为0，发生除法异常&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>若抛出了自定义的异常： ExceptionHandlerExceptionResolver 异常处理解析器不会解析此异常。</li>
<li>又因为触发的自定义异常 带有@ResponseStatus注解。因此会被ResponseStatusExceptionResolver 解析到。最后响应HttpStatus.UNAUTHORIZED 代码给客户端。HttpStatus.UNAUTHORIZED 代表响应码401，无权限。</li>
<li>关于其他的响应码请参考 HttpStatus 枚举类型源码。</li>
</ul>
<p><strong>DefaultHandlerExceptionResolver默认异常解析器</strong></p>
<ul>
<li>对一些特殊的异常进行处理，比如NoSuchRequestHandlingMethodException、HttpRequestMethodNotSupportedException、HttpMediaTypeNotSupportedException、HttpMediaTypeNotAcceptableException等。</li>
</ul>
<p><strong>SimpleMappingExceptionResolver映射异常解析器</strong></p>
<ul>
<li>如果希望对所有异常进行统一处理，可以使用SimpleMappingExceptionResolver，它将异常类名映射为视图名，即发生异常时使用对应的视图报告异常。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--对所有异常进行统一处理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">&quot;simpleMappingExceptionResolver&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--出现异常时要映射到哪个页面--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;exceptionMappings&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--将算数异常映射到error.jsp页面--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;java.lang.ArithmeticException&quot;</span>&gt;</span>error<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="第十四章-总结"><a href="#第十四章-总结" class="headerlink" title="第十四章 总结"></a>第十四章 总结</h1><ul>
<li>在控制层，所有的控制方法，如果有自定义的pojo类型的形参，则会在此请求结束后，将形参的数据添加到request域属型中。</li>
<li>SpringMVC的运行流程</li>
</ul>
<p><img src="https://gitee.com/plumChuan/picture-bed/raw/master/img/20210318125159.png"></p>
<h1 id="第十五章-Spring与SpringMVC的整合"><a href="#第十五章-Spring与SpringMVC的整合" class="headerlink" title="第十五章 Spring与SpringMVC的整合"></a>第十五章 Spring与SpringMVC的整合</h1><ul>
<li><p>Spring与SpringMVC的整合</p>
<ul>
<li>需要整合：通常情况下，类似于数据源，事务，整合其他框架都是放在Spring的配置文件中的，而且service和dao层也是都放在Spring中的。</li>
<li>不需要整合：也可以都放在SpringMVC中，也可以分多个配置文件，然后在主配置文件中通过import标签导入其他配置文件。</li>
<li>推荐整合，使用Spring和SpringMVC两个配置文件。</li>
</ul>
</li>
<li><p>问题1：当Spring的IOC容器和SpringMVC的IOC扫描的包有重复时，会导致由的bean被创建两次。</p>
<ul>
<li>解决1：让它们扫描不同的包，</li>
<li>解决2：扫描包可以重复，使用exclude-filter和include-filter规定扫描的注解要不同。</li>
</ul>
</li>
<li><p>整合示例：</p>
<ul>
<li>Spring的配置文件：Spring-Config.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--只不扫描Controller和ControllerAdvice注解的bean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.lc&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.web.bind.annotation.ControllerAdvice&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>SpringMVC配置文件：SpringMVC-Config.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--只扫描Controller和ControllerAdvice注解的bean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.lc&quot;</span> <span class="attr">use-default-filters</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.web.bind.annotation.ControllerAdvice&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>web.xml配置文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:*-Config.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>注意：SpringMVC中的bean可以引用Spring中的bean。反之则不行。</p>
</li>
<li><p>在 Spring MVC 配置文件中引用业务层的 Bean。</p>
<ul>
<li>多个 Spring IOC 容器之间可以设置为父子关系，以实现良好的解耦。 </li>
<li>Spring MVC WEB 层容器可作为 “业务层” Spring 容器的子容器：即 WEB 层容器可以引用业务层容器的 Bean，而业务层容器却访问不到 WEB 层容器的 Bean。</li>
</ul>
</li>
</ul>
<h1 id="第十六章-SpringMVC与Struts2的对比"><a href="#第十六章-SpringMVC与Struts2的对比" class="headerlink" title="第十六章 SpringMVC与Struts2的对比"></a>第十六章 SpringMVC与Struts2的对比</h1><ul>
<li>①. Spring MVC 的入口是 Servlet, 而 Struts2 是 Filter</li>
<li>②. Spring MVC 会稍微比 Struts2 快些. Spring MVC 是基于方法设计, 而 Sturts2 是基于类, 每次发一次请求都会实例一个 Action.</li>
<li>③. Spring MVC 使用更加简洁, 开发效率Spring MVC确实比 struts2 高: 支持 JSR303, 处理 ajax 的请求更方便</li>
<li>④. Struts2 的 OGNL 表达式使页面的开发效率相比Spring MVC 更高些.</li>
</ul>

    </div>

    
    
    


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/03/16/%E5%B0%9A%E7%A1%85%E8%B0%B7%E8%AF%B4Java/%E5%89%8D%E7%AB%AF/Servlet/" rel="prev" title="Servlet学习">
      <i class="fa fa-chevron-left"></i> Servlet学习
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/03/23/%E5%B0%9A%E7%A1%85%E8%B0%B7%E8%AF%B4Java/%E9%A1%B9%E7%9B%AE/ssm%E6%95%B4%E5%90%88/" rel="next" title="ssm整合之CRUD操作">
      ssm整合之CRUD操作 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%85%A5%E9%97%A8"><span class="nav-number">1.</span> <span class="nav-text">第一章 入门</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-RequestMapping%E6%B3%A8%E8%A7%A3"><span class="nav-number">2.</span> <span class="nav-text">第二章 RequestMapping注解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-RequestMapping%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 @RequestMapping的属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-RequestMapping%E6%B3%A8%E8%A7%A3%E8%AF%B7%E6%B1%82%E6%98%A0%E5%B0%84%E7%9A%84%E9%A3%8E%E6%A0%BC"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 RequestMapping注解请求映射的风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-PathVariable-%E6%98%A0%E5%B0%84-URL-%E7%BB%91%E5%AE%9A%E7%9A%84%E5%8D%A0%E4%BD%8D%E7%AC%A6"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 @PathVariable 映射 URL 绑定的占位符</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-REST%E9%A3%8E%E6%A0%BC"><span class="nav-number">3.</span> <span class="nav-text">第三章 REST风格</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E6%98%A0%E5%B0%84%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E5%92%8C%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="nav-number">4.</span> <span class="nav-text">第四章 映射请求参数和请求参数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 请求参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E8%AF%B7%E6%B1%82%E5%A4%B4"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 请求头</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-Cookie%E4%BF%A1%E6%81%AF%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 Cookie信息的获取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-POJO%E5%AF%B9%E8%B1%A1%E7%BB%91%E5%AE%9A"><span class="nav-number">4.4.</span> <span class="nav-text">4.4 POJO对象绑定</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-%E6%8E%A5%E5%8F%97Servlet%E7%9A%84%E5%8E%9F%E7%94%9FAPI%E5%8F%82%E6%95%B0"><span class="nav-number">4.5.</span> <span class="nav-text">4.5 接受Servlet的原生API参数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-%E6%A8%A1%E5%9E%8B%E6%95%B0%E6%8D%AE"><span class="nav-number">5.</span> <span class="nav-text">第五章 模型数据</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-ModelAndView"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 ModelAndView</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-Map-%E5%8F%8AModel"><span class="nav-number">5.2.</span> <span class="nav-text">5.2 Map 及Model</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-SessionAttributes%E6%B3%A8%E8%A7%A3"><span class="nav-number">5.3.</span> <span class="nav-text">5.3 @SessionAttributes注解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-ModelAttribute%E6%B3%A8%E8%A7%A3"><span class="nav-number">5.4.</span> <span class="nav-text">5.4 @ModelAttribute注解</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E8%A7%86%E5%9B%BE%E5%8F%8A%E8%A7%86%E5%9B%BE%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="nav-number">6.</span> <span class="nav-text">第六章 视图及视图解析器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-%E8%A7%86%E5%9B%BE"><span class="nav-number">6.1.</span> <span class="nav-text">6.1 视图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-%E8%A7%86%E5%9B%BE%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="nav-number">6.2.</span> <span class="nav-text">6.2 视图解析器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-%E9%87%8D%E5%AE%9A%E5%90%91%E5%92%8C%E8%BD%AC%E5%8F%91"><span class="nav-number">6.3.</span> <span class="nav-text">6.3 重定向和转发</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0-%E8%A1%A8%E5%8D%95%E6%A0%87%E7%AD%BE%E5%92%8C%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9A%84%E5%A4%84%E7%90%86"><span class="nav-number">7.</span> <span class="nav-text">第七章 表单标签和静态资源的处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-lt-form-form-gt-%E6%A0%87%E7%AD%BE"><span class="nav-number">7.1.</span> <span class="nav-text">7.1 &lt;form:form&gt; 标签</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-%E5%A4%84%E7%90%86%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"><span class="nav-number">7.2.</span> <span class="nav-text">7.2 处理静态资源</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%85%AB%E7%AB%A0-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%BD%AC%E6%8D%A2%EF%BC%8C%E6%A0%BC%E5%BC%8F%E5%8C%96%EF%BC%8C%E6%A0%A1%E9%AA%8C"><span class="nav-number">8.</span> <span class="nav-text">第八章 数据的转换，格式化，校验</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E6%B5%81%E7%A8%8B"><span class="nav-number">8.1.</span> <span class="nav-text">8.1 数据绑定流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2"><span class="nav-number">8.2.</span> <span class="nav-text">8.2 数据转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3-%E5%85%B3%E4%BA%8E-lt-mvc-annotation-driven-gt-%E9%85%8D%E7%BD%AE"><span class="nav-number">8.3.</span> <span class="nav-text">8.3 关于&lt;mvc:annotation-driven&#x2F;&gt;配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4-InitBinder%E6%B3%A8%E8%A7%A3"><span class="nav-number">8.4.</span> <span class="nav-text">8.4 @InitBinder注解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-5-%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="nav-number">8.5.</span> <span class="nav-text">8.5 数据格式化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-6-%E6%95%B0%E6%8D%AE%E6%A0%A1%E9%AA%8C"><span class="nav-number">8.6.</span> <span class="nav-text">8.6 数据校验</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B9%9D%E7%AB%A0-JSON"><span class="nav-number">9.</span> <span class="nav-text">第九章 JSON</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E7%AB%A0-%E5%9B%BD%E9%99%85%E5%8C%96%E5%A4%84%E7%90%86"><span class="nav-number">10.</span> <span class="nav-text">第十章 国际化处理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0-%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0"><span class="nav-number">11.</span> <span class="nav-text">第十一章 文件的上传</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0-%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-number">12.</span> <span class="nav-text">第十二章 拦截器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="nav-number">13.</span> <span class="nav-text">第十三章 异常处理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0-%E6%80%BB%E7%BB%93"><span class="nav-number">14.</span> <span class="nav-text">第十四章 总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E4%BA%94%E7%AB%A0-Spring%E4%B8%8ESpringMVC%E7%9A%84%E6%95%B4%E5%90%88"><span class="nav-number">15.</span> <span class="nav-text">第十五章 Spring与SpringMVC的整合</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E5%85%AD%E7%AB%A0-SpringMVC%E4%B8%8EStruts2%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="nav-number">16.</span> <span class="nav-text">第十六章 SpringMVC与Struts2的对比</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Plum Reiver</p>
  <div class="site-description" itemprop="description">技术，日常，笔记</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">90</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
	
  </nav>
</div>


      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Plum Reiver</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
